<!doctype>
<html>
<head>
  <link rel="stylesheet" href="leaflet.min.css"/>
  <style>
    #map { height: 180px; }
  </style>
</head>

<body>

  <div id="map"></div>

  <script src="head.load.min.js"></script>
  <script>
    head
    .js("leaflet.min.js")
    .ready(function(){

      // create a map in the "map" div, set the view to a given place and zoom
      var map = L.map('map').setView([-21.2105, -45.0109], 13);

      // add a CloudMade tile layer with style #997
      L.tileLayer('http://{s}.tile.cloudmade.com/4545df0a35ca4aa1bbf2afaab46c68e0/997/256/{z}/{x}/{y}.png', {
          attribution: '',
          maxZoom: 18
      }).addTo(map);

      map.on('locationfound', function(e){
        var radius = e.accuracy / 2;
        L.marker(e.latlng).addTo(map)
          .bindPopup("You are within " + radius + " meters from this point").openPopup();

        L.circle(e.latlng, radius).addTo(map);
      });

      map.on('locationerror', function onLocationError(e) {
        alert(e.message);
      });

      //map.locate({setView: true, maxZoom: 16});

      // add a marker in the given location, attach some popup content to it and open the popup
      L.marker([-21.2105, -45.0109]).addTo(map)
          .bindPopup('A pretty CSS3 popup. <br> Easily customizable.').openPopup();

    })
    ;
  </script>
</body>
</html>
