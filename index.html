<!doctype>
<html>
<head>
  <link rel="stylesheet" href="leaflet.min.css"/>
  <style>
    #map { 
      height: 100%; 
    }
  </style>
</head>

<body>

  <div id="map"></div>

  <script src="head.load.min.js"></script>
  <script>
    head
    .js("leaflet.min.js")
    .js("MapOnJS.js")
    .js("Local.js")
    .ready(function(){

      var map = MapOnJS.map;

      /************
      * Localização
      *************/
      map.on('locationfound', function(e){
        var radius = e.accuracy / 2;

        //Adicionando um Marker com a localização
        L.marker(e.latlng)
        .addTo(map)
        .bindPopup("Você está em um raio de " + radius + " metros desse ponto")
        .openPopup()
        .on('click', function(e){
          var latlng = e.target.getLatLng();
          console.log(latlng.toLocaleString());
        });

        L.circle(e.latlng, radius) //criando raio de localização
        .addTo(map) //Adicionando o raio de localizacao
        .bringToBack(); //movendo o raio de localização para ficar atrás da camada de Locais
        map.setView(e.latlng, 15); //alterando view no mapa
      });

      map.on('locationerror', function onLocationError(e) {
        alert(e.message);
      });

      map.locate({setView: true, maxZoom: 18});
      /************
      * FIM Localização
      *************/


      /************
      * Adicionando locais no mapa
      *************/
      MapOnJS.Local
      .addToMap(MapOnJS.Local.evolutio)
      .addToMap(MapOnJS.Local.shopping)
      .addToMap(MapOnJS.Local.casaDoBahia)
      .addToMap(MapOnJS.Local.casaDaGleyce)
      .addToMap(MapOnJS.Local.lemaf);
      /************
      * FIM da adição dos locais no mapa
      *************/
      

    })
    ;
  </script>
</body>
</html>
